# Covariance Matrix Distributions

The covariance matrix distributions have support on symmetric,
positive-definite $K \times K$ matrices.

## Wishart Distribution

### Probability Density Function

If $K \in \mathbb{N}$, $\nu \in (K-1,\infty)$, and $S \in
\mathbb{R}^{K \times K}$ is symmetric and positive definite, then for
symmetric and positive-definite $W \in \mathbb{R}^{K \times K}$, \[
\text{Wishart}(W|\nu,S) = \frac{1}{2^{\nu K / 2}} \ \frac{1}{\Gamma_K
\! \left( \frac{\nu}{2} \right)} \ \left| S \right|^{-\nu/2} \ \left|
W \right|^{(\nu - K - 1)/2} \ \exp \! \left(- \frac{1}{2} \
\text{tr}\left( S^{-1} W \right) \right) \! , \] where $\text{tr}()$
is the matrix trace function, and $\Gamma_K()$ is the multivariate
Gamma function, \[ \Gamma_K(x) = \frac{1}{\pi^{K(K-1)/4}} \
\prod_{k=1}^K \Gamma \left( x + \frac{1 - k}{2} \right) \!. \]

\pitem{W}{wishart}{nu, Sigma}

### Stan Functions

<!-- wishart -->
<!-- real; wishart_lpdf; (matrix W | real nu, matrix Sigma); -->

`real` **`wishart_lpdf`**(`matrix W | real nu, matrix Sigma`)
The log of the Wishart density for symmetric and positive-definite
matrix W given degrees of freedom nu and symmetric and
positive-definite scale matrix Sigma

<!-- wishart -->
<!-- matrix; wishart_rng; (real nu, matrix Sigma); -->

`matrix` **`wishart_rng`**(`real nu, matrix Sigma`)
Generate a Wishart variate with degrees of freedom nu and symmetric
and positive-definite scale matrix Sigma; may only be used in
generated quantities block

## Inverse Wishart Distribution

### Probability Density Function

If $K \in \mathbb{N}$, $\nu \in (K-1,\infty)$, and $S \in
\mathbb{R}^{K \times   K}$ is symmetric and positive definite, then
for symmetric and positive-definite $W \in \mathbb{R}^{K \times K}$,
\[ \text{InvWishart}(W|\nu,S) = \frac{1}{2^{\nu K / 2}} \
\frac{1}{\Gamma_K \! \left( \frac{\nu}{2} \right)} \ \left| S
\right|^{\nu/2} \ \left| W \right|^{-(\nu + K + 1)/2} \ \exp \! \left(
- \frac{1}{2} \ \text{tr}(SW^{-1}) \right) \! . \]

\pitem{W}{inv_wishart}{nu, Sigma}

### Stan Functions

<!-- inv_wishart -->
<!-- real; inv_wishart_lpdf; (matrix W | real nu, matrix Sigma); -->

`real` **`inv_wishart_lpdf`**(`matrix W | real nu, matrix Sigma`)
The log of the inverse Wishart density for symmetric and
positive-definite matrix W given degrees of freedom nu and symmetric
and positive-definite scale matrix Sigma

<!-- inv_wishart -->
<!-- matrix; inv_wishart_rng; (real nu, matrix Sigma); -->

`matrix` **`inv_wishart_rng`**(`real nu, matrix Sigma`)
Generate an inverse Wishart variate with degrees of freedom nu and
symmetric and positive-definite scale matrix Sigma; may only be used
in generated quantities block

